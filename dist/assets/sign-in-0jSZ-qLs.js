import{r as o,b0 as A,p as n,bF as T,j as s,S as l,B as b,R as m,cu as z,T as w,W as S,b as v,D,ak as y,al as k,am as C,bH as P,be as R,cw as U,aZ as B,H,a as W}from"./index-C5-7V04H.js";import{S as $}from"./split-layout-C-JKiTiu.js";import{u as q,C as L,t as O,z as u}from"./index-DvGAAjB3.js";import{n as G,R as N}from"./EyeSlash-CtcCRaqc.js";import{c as V}from"./client-B6InYSCG.js";const Z=[{id:"google",name:"Google",logo:"/assets/logo-google.svg"},{id:"discord",name:"Discord",logo:"/assets/logo-discord.svg"}],J=u.object({email:u.string().min(1,{message:"Email is required"}).email(),password:u.string().min(1,{message:"Password is required"})}),K={email:"",password:""};function M(){const[a]=o.useState(V()),i=A(),[c,g]=o.useState(),[p,d]=o.useState(!1),{control:x,handleSubmit:E,setError:j,formState:{errors:r}}=q({defaultValues:K,resolver:O(J)}),F=o.useCallback(async e=>{d(!0);const t=new URL(n.auth.supabase.callback,globalThis.location.origin);t.searchParams.set("next",n.dashboard.overview);const{data:h,error:f}=await a.auth.signInWithOAuth({provider:e,options:{redirectTo:t.href}});if(f){d(!1),T.error(f.message);return}globalThis.location.href=h.url},[a]),I=o.useCallback(async e=>{d(!0);const{error:t}=await a.auth.signInWithPassword({email:e.email,password:e.password});if(t)if(t.message.includes("Email not confirmed")){const h=new URLSearchParams({email:e.email});i(`${n.auth.supabase.signUpConfirm}?${h.toString()}`)}else j("root",{type:"server",message:t.message}),d(!1)},[a,i,j]);return s.jsxs(l,{spacing:4,children:[s.jsx("div",{children:s.jsx(b,{component:m,href:n.home,sx:{display:"inline-block",fontSize:0},children:s.jsx(z,{colorDark:"light",colorLight:"dark",height:32,width:122})})}),s.jsxs(l,{spacing:1,children:[s.jsx(w,{variant:"h5",children:"Sign in"}),s.jsxs(w,{color:"text.secondary",variant:"body2",children:["Don't have an account?"," ",s.jsx(S,{component:m,href:n.auth.supabase.signUp,variant:"subtitle2",children:"Sign up"})]})]}),s.jsxs(l,{spacing:3,children:[s.jsx(l,{spacing:2,children:Z.map(e=>s.jsxs(v,{color:"secondary",disabled:p,endIcon:s.jsx(b,{alt:"",component:"img",height:24,src:e.logo,width:24}),onClick:()=>{F(e.id).catch(()=>{})},variant:"outlined",children:["Continue with ",e.name]},e.id))}),s.jsx(D,{children:"or"}),s.jsxs(l,{spacing:2,children:[s.jsx("form",{onSubmit:E(I),children:s.jsxs(l,{spacing:2,children:[s.jsx(L,{control:x,name:"email",render:({field:e})=>s.jsxs(y,{error:!!r.email,children:[s.jsx(k,{children:"Email address"}),s.jsx(C,{...e,type:"email"}),r.email?s.jsx(P,{children:r.email.message}):null]})}),s.jsx(L,{control:x,name:"password",render:({field:e})=>s.jsxs(y,{error:!!r.password,children:[s.jsx(k,{children:"Password"}),s.jsx(C,{...e,endAdornment:c?s.jsx(G,{cursor:"pointer",fontSize:"var(--icon-fontSize-md)",onClick:()=>{g(!1)}}):s.jsx(N,{cursor:"pointer",fontSize:"var(--icon-fontSize-md)",onClick:()=>{g(!0)}}),type:c?"text":"password"}),r.password?s.jsx(P,{children:r.password.message}):null]})}),r.root?s.jsx(R,{color:"error",children:r.root.message}):null,s.jsx(v,{disabled:p,type:"submit",variant:"contained",children:"Sign in"})]})}),s.jsx("div",{children:s.jsx(S,{component:m,href:n.auth.supabase.resetPassword,variant:"subtitle2",children:"Forgot password?"})})]})]})]})}const Q={title:`Sign in | Supabase | Auth | ${W.name}`};function as(){const{isAuthenticated:a,isLoading:i}=U(),c=A();return o.useEffect(()=>{i||!a||(B.debug("[Sign in] User is authenticated, redirecting to dashboard"),c(n.dashboard.overview))},[a,i,c]),i||a?null:s.jsxs(o.Fragment,{children:[s.jsx(H,{children:s.jsx("title",{children:Q.title})}),s.jsx($,{children:s.jsx(M,{})})]})}export{as as Page};
