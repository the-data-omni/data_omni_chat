import{r as s,aZ as F,j as e,S as y,a_ as R,am as T,ao as B,ap as D,a$ as M,P,B as C,T as u,L as z,y as W,a6 as E,z as H,Q as v,A as Q,F as N,b0 as X,b1 as $,p as q,D as S,H as G,a as O}from"./index-C5-7V04H.js";import{M as V}from"./message-add-4xeHhCxK.js";import"./modal-1-C5ssiXW2.js";import"./option-BD2v2nDd.js";import"./LinearProgress-CTIsyjhu.js";import"./TableHead-BnjFcU27.js";import"./PaperPlaneTilt-rxVchyzl.js";function Z({contacts:l,onRecipientAdd:n,onRecipientRemove:i,recipients:c=[]}){const o=s.useRef(null),[t,r]=s.useState(!1),[d,x]=s.useState(""),[p,m]=s.useState([]),h=t&&!!d,j=p.length>0,w=s.useCallback(async a=>{const f=a.target.value;if(x(f),!f){m([]);return}try{const g=l.filter(b=>c.some(A=>A.id===b.id)?!1:b.name.toLowerCase().includes(f.toLowerCase()));m(g)}catch(g){F.error(g)}},[l,c]),k=s.useCallback(()=>{h&&r(!1)},[h]),I=s.useCallback(()=>{r(!0)},[]),L=s.useCallback(a=>{x(""),n==null||n(a)},[n]);return e.jsxs(y,{direction:"row",spacing:2,sx:{alignItems:"center",overflowX:"auto",p:2},children:[e.jsx(R,{onClickAway:k,children:e.jsxs("div",{children:[e.jsx(T,{onChange:w,onFocus:I,placeholder:"Search contacts",ref:o,startAdornment:e.jsx(B,{position:"start",children:e.jsx(D,{fontSize:"var(--icon-fontSize-md)"})}),sx:{minWidth:"260px"},value:d}),h?e.jsx(M,{anchorEl:o.current,open:t,placement:"bottom-start",children:e.jsx(P,{sx:{border:"1px solid var(--mui-palette-divider)",boxShadow:"var(--mui-shadows-16)",maxWidth:"100%",mt:1,width:"320px"},children:j?e.jsxs(s.Fragment,{children:[e.jsx(C,{sx:{px:3,py:2},children:e.jsx(u,{color:"text.secondary",variant:"subtitle2",children:"Contacts"})}),e.jsx(z,{sx:{p:1,"& .MuiListItemButton-root":{borderRadius:1}},children:p.map(a=>e.jsx(W,{disablePadding:!0,children:e.jsxs(E,{onClick:()=>{L(a)},children:[e.jsx(H,{children:e.jsx(v,{src:a.avatar,sx:{"--Avatar-size":"32px"}})}),e.jsx(Q,{disableTypography:!0,primary:e.jsx(u,{noWrap:!0,variant:"subtitle2",children:a.name})})]})},a.id))})]}):e.jsxs(y,{spacing:1,sx:{p:2,textAlign:"center"},children:[e.jsx(u,{variant:"h6",children:"Nothing found"}),e.jsxs(u,{color:"text.secondary",variant:"body2",children:[`We couldn't find any matches for "`,d,'". Try checking for typos or using complete words.']})]})})}):null]})}),e.jsx(u,{color:"text.secondary",variant:"body2",children:"To:"}),e.jsx(y,{direction:"row",spacing:2,sx:{alignItems:"center",overflowX:"auto"},children:c.map(a=>e.jsx(N,{avatar:e.jsx(v,{src:a.avatar}),label:a.name,onDelete:()=>{i==null||i(a.id)}},a.id))})]})}function _(){const[l,n]=s.useState([]),i=s.useCallback(o=>{n(t=>t.find(d=>d.id===o.id)?t:[...t,o])},[]),c=s.useCallback(o=>{n(t=>t.filter(r=>r.id!==o))},[]);return{handleRecipientAdd:i,handleRecipientRemove:c,recipients:l}}function J(){const l=X(),{contacts:n,createThread:i,createMessage:c}=s.useContext($),{handleRecipientAdd:o,handleRecipientRemove:t,recipients:r}=_(),d=s.useCallback(async(x,p)=>{const m=r.map(j=>j.id),h=i({type:"group",recipientIds:m});c({threadId:h,type:x,content:p}),l(q.dashboard.chat.thread("group",h))},[l,i,c,r]);return e.jsxs(C,{sx:{display:"flex",flex:"1 1 auto",flexDirection:"column",minHeight:0},children:[e.jsx(Z,{contacts:n,onRecipientAdd:o,onRecipientRemove:t,recipients:r}),e.jsx(S,{}),e.jsx(C,{sx:{flex:"1 1 auto"}}),e.jsx(S,{}),e.jsx(V,{disabled:r.length===0,onSend:d})]})}const K={title:`Compose | Chat | Dashboard | ${O.name}`};function ne(){return e.jsxs(s.Fragment,{children:[e.jsx(G,{children:e.jsx("title",{children:K.title})}),e.jsx(J,{})]})}export{ne as Page};
